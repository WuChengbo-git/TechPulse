# TechPulse 项目文件结构详细说明

> 本文档详细说明 TechPulse 项目的前后端文件结构，帮助开发者快速理解项目架构。
>
> **版本**: 0.3.0
> **更新日期**: 2025-11-05

---

## 目录

- [1. 项目整体结构](#1-项目整体结构)
- [2. 后端结构 (Backend)](#2-后端结构-backend)
- [3. 前端结构 (Frontend)](#3-前端结构-frontend)
- [4. 其他目录](#4-其他目录)
- [5. 最近更新](#5-最近更新-v030)

---

## 1. 项目整体结构

```
TechPulse/
├── backend/              # 后端应用 (FastAPI + Python)
├── frontend/             # 前端应用 (React + TypeScript + Vite)
├── docs/                 # 项目文档
├── scripts/              # 辅助脚本
├── logs/                 # 运行日志
└── .git/                 # Git 版本控制
```

---

## 2. 后端结构 (Backend)

### 2.1 技术栈

- **框架**: FastAPI (异步 Python Web 框架)
- **数据库**: SQLAlchemy ORM + SQLite (开发) / PostgreSQL (生产)
- **认证**: JWT (当前使用 auth.py 基础认证)
- **AI/LLM**: 统一 LLM 服务层，支持多provider (Azure OpenAI, Ollama 等)
- **任务调度**: APScheduler
- **数据迁移**: Alembic

### 2.2 目录结构

```
backend/
├── app/
│   ├── main.py           # FastAPI 应用入口，端口 8000
│   │
│   ├── core/             # 核心配置
│   │   ├── config.py
│   │   ├── database.py
│   │   ├── security.py   # JWT + 密码加密
│   │   └── version.py    # 从 package.json 读取版本
│   │
│   ├── models/           # 数据模型
│   │   ├── user.py
│   │   ├── card.py
│   │   ├── llm_provider.py
│   │   ├── llm_model.py
│   │   └── ...
│   │
│   ├── api/              # API 路由（19个）
│   │   ├── auth.py       # 基础认证（当前使用）
│   │   ├── auth_enhanced.py  # 增强认证（可选，需额外依赖）
│   │   ├── oauth.py      # OAuth（可选，需额外依赖）
│   │   ├── llm_providers.py  # LLM 提供商管理
│   │   ├── cards.py
│   │   ├── sources.py
│   │   ├── search.py
│   │   ├── recommend.py
│   │   └── ...
│   │
│   ├── services/         # 业务逻辑
│   │   ├── data_collector.py
│   │   ├── scheduler.py
│   │   ├── llm/          # LLM 服务层
│   │   │   ├── base.py
│   │   │   ├── azure_openai.py
│   │   │   ├── ollama.py
│   │   │   └── factory.py
│   │   └── scrapers/
│   │
│   └── utils/
│
├── tests/                # 176个测试，覆盖率35%
├── scripts/
├── pyproject.toml
└── techpulse.db          # SQLite 数据库
```

### 2.3 API 端点

**Base URL**: `http://localhost:8000/api/v1/`

| 路由 | 说明 |
|------|------|
| `/auth/*` | 认证（注册、登录、修改密码） |
| `/llm-providers/*` | LLM 提供商管理 |
| `/cards/*` | 技术卡片 CRUD |
| `/search/*` | 智能搜索 |
| `/recommend/*` | 推荐系统 |
| `/health/*` | 健康检查 |

---

## 3. 前端结构 (Frontend)

### 3.1 技术栈

- **框架**: React 18 + TypeScript 5
- **构建**: Vite 4.5 (端口 5174)
- **路由**: React Router v6 (真实 URL 路由)
- **UI**: Ant Design 5.11
- **状态**: Context API
- **HTTP**: Axios (代理到 localhost:8000)
- **国际化**: 完整的中/英/日支持

### 3.2 目录结构

```
frontend/
├── src/
│   ├── main.tsx          # 入口
│   ├── App.tsx           # 主组件 + 路由配置
│   │
│   ├── config/
│   │   └── version.ts    # 从 package.json 读取版本
│   │
│   ├── pages/            # 15个页面
│   │   ├── Login.tsx     # /login
│   │   ├── Overview.tsx  # / 或 /dashboard
│   │   ├── Dashboard.tsx # /trending
│   │   ├── GitHubPage.tsx
│   │   ├── ArxivPage.tsx
│   │   ├── HuggingFacePage.tsx
│   │   ├── ZennPage.tsx
│   │   ├── TrendsPage.tsx    # /trends (趋势分析)
│   │   ├── Analytics.tsx
│   │   ├── Chat.tsx
│   │   ├── ApiConfigPage.tsx
│   │   ├── LLMProvidersPage.tsx  # /llm-providers (LLM 管理)
│   │   ├── SettingsPage.tsx      # /settings (已简化)
│   │   ├── TaskManagementPage.tsx
│   │   └── SystemStatusPage.tsx
│   │
│   ├── components/
│   │   ├── LanguageSelector.tsx  # 语言切换器
│   │   └── ...
│   │
│   ├── contexts/
│   │   └── LanguageContext.tsx   # 多语言管理
│   │
│   ├── locales/
│   │   └── translations.ts       # 2700+ 行翻译
│   │
│   ├── services/
│   │   ├── llmService.ts
│   │   ├── systemConfigService.ts
│   │   └── userSettingsService.ts
│   │
│   └── utils/
│       └── api.ts        # Axios 实例 + 拦截器
│
├── package.json          # version: 0.3.0
├── vite.config.ts        # port: 5174, proxy: 8000
└── tsconfig.json
```

### 3.3 路由系统

```
URL                    → 组件
/                      → Overview
/login                 → Login
/trending              → Dashboard (GitHub Trending)
/github                → GitHubPage
/arxiv                 → ArxivPage
/huggingface           → HuggingFacePage
/zenn                  → ZennPage
/trends                → TrendsPage
/analytics             → Analytics
/chat                  → Chat
/api-config            → ApiConfigPage
/llm-providers         → LLMProvidersPage
/settings              → SettingsPage
/tasks                 → TaskManagementPage
/status                → SystemStatusPage
```

### 3.4 关键配置

**vite.config.ts**:
```typescript
export default defineConfig({
  server: {
    port: 5174,
    proxy: {
      '/api': {
        target: 'http://localhost:8000',  // 后端地址
        changeOrigin: true,
      },
    },
  },
})
```

**config/version.ts**:
```typescript
import packageJson from '../../package.json'

export const APP_VERSION = packageJson.version  // 0.3.0
export const BUILD_DATE = new Date().toISOString()...
```

---

## 4. 其他目录

```
TechPulse/
├── docs/
│   ├── RELEASE.md              # 版本历史
│   ├── DEVELOPMENT_LOG.md      # 开发日志
│   ├── FUTURE_FEATURES.md      # 待开发功能
│   ├── SETUP_GUIDE.md          # 安装指南
│   ├── DEPLOYMENT_GUIDE.md     # 部署指南
│   ├── VERSION_MANAGEMENT.md   # 版本管理
│   └── 项目文件结构说明.md     # 本文档
│
├── scripts/
│   ├── dev.sh                  # 开发启动（gitignored）
│   ├── start.sh                # 生产启动（gitignored）
│   └── update_version.py       # 版本更新
│
├── logs/                       # 应用日志
│
├── .gitignore                  # Git 忽略规则
├── README.md                   # 中文说明
├── README.en.md                # 英文说明
├── README.ja.md                # 日文说明
└── LICENSE                     # MIT 许可证
```

---

## 5. 最近更新 (v0.3.0)

### 5.1 前端优化

✅ **移除重复组件**
- 删除 `LanguageSwitch.tsx`，统一使用 `LanguageSelector.tsx`

✅ **简化 SettingsPage**
- 从 764 行减少到 217 行（-71%）
- 移除 AI 模型配置标签页（重复功能）
- AI 模型统一在 `LLMProvidersPage` 管理
- 添加 Alert 引导用户到正确页面

✅ **真实 URL 路由**
- 从状态路由迁移到 React Router v6
- 支持浏览器前进/后退
- 可直接访问任意路由

✅ **完善多语言**
- 所有错误提示支持三语言
- Settings 页面 Alert 完整翻译
- 登录错误根据界面语言显示

✅ **修复关键 Bug**
- 修正 Vite 代理端口 8001 → 8000
- 修复登录连接问题
- 恢复稳定认证系统（使用 auth.py）

### 5.2 后端优化

✅ **统一版本管理**
- 前后端从 `package.json` 读取统一版本号

✅ **认证系统**
- 使用稳定的 `auth.py`（基础认证）
- `auth_enhanced.py` 和 `oauth.py` 保留为可选功能
- 实现完整的修改密码功能

✅ **LLM 服务层**
- 统一的 LLM 接口
- 支持多 provider（Azure, Ollama 等）
- 工厂模式创建实例

### 5.3 文档更新

✅ 更新项目文件结构说明（本文档）
✅ 版本号统一为 0.3.0
✅ 更新日期: 2025-11-05

---

## 6. 快速开始

### 6.1 后端

```bash
cd backend
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

访问: http://localhost:8000/docs

### 6.2 前端

```bash
cd frontend
npm install
npm run dev
```

访问: http://localhost:5174

---

## 7. 常见问题

**Q: 为什么前端端口是 5174？**

A: 在 `vite.config.ts` 中自定义配置，避免端口冲突。

**Q: API 代理如何工作？**

A: Vite 开发服务器将 `/api` 请求代理到 `http://localhost:8000`，避免 CORS 问题。

**Q: 如何添加新翻译？**

A: 在 `frontend/src/locales/translations.ts` 中添加 zh-CN、en-US、ja-JP 三种语言的键值对。

**Q: 如何切换 LLM provider？**

A: 访问 `/llm-providers` 页面，配置不同的 provider（OpenAI、Azure、Ollama 等）。

**Q: 为什么有两个认证文件？**

A: `auth.py` 是基础认证（当前使用），`auth_enhanced.py` 需要额外依赖（pyotp, qrcode, authlib），暂未启用。

---

## 8. 架构图

```
┌─────────────────────┐
│   浏览器/桌面应用    │
│   React + Vite      │
│   端口: 5174        │
└──────────┬──────────┘
           │ HTTP /api/*
           ↓
┌─────────────────────┐
│   FastAPI 后端      │
│   端口: 8000        │
│   JWT 认证          │
└──────────┬──────────┘
           │
           ↓
┌─────────────────────┐
│   SQLite 数据库     │
│   techpulse.db      │
└─────────────────────┘
           ↑
           │
┌─────────────────────┐
│   数据采集层         │
│   GitHub | arXiv    │
│   HF | Zenn         │
└─────────────────────┘
```

---

## 9. 总结

### 项目特点

1. ✅ **统一版本管理** - 前后端版本号从 `package.json` 统一读取
2. ✅ **完整国际化** - 中英日三语言，2700+ 翻译条目
3. ✅ **代码简洁** - 移除重复组件和功能，持续优化
4. ✅ **真实路由** - React Router v6，支持浏览器导航
5. ✅ **LLM 集成** - 统一服务接口，轻松切换 provider
6. ✅ **稳定认证** - JWT 基础认证 + 修改密码功能

### 开发建议

**前端入门**:
1. 从 `Login.tsx` 了解认证流程
2. 查看 `LanguageContext.tsx` 学习多语言
3. 理解 `utils/api.ts` 的拦截器机制

**后端入门**:
1. 从 `api/health.py` 开始
2. 查看 `api/auth.py` 理解认证
3. 学习 `services/data_collector.py` 了解数据采集

---

**文档版本**: v0.3.0  
**最后更新**: 2025-11-05  
**维护者**: TechPulse Team  

**重要提示**: 本文档应在每次重大更新后及时维护。
